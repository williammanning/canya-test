<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canya - Community Services & Resources</title>
    <link rel="stylesheet" href="/styles.css">
    <link rel="icon" href="/images/favicon.svg" type="image/svg+xml">
    <script type="module" src="/js/ld.js"></script>
    <script type="module" src="/js/chatbot.js"></script>
</head>
<body>
    <header>
        <nav>
            <a href="/" class="logo"><img src="/images/canya-logo.svg" alt="Canya logo" class="site-logo"></a>
            <p class="header-tagline">Connecting communities with resources and services for a better world</p>
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <li><a href="/services">Services</a></li>
                <li><a href="/about">About Us</a></li>
                <li><a href="#" onclick="checkUserLogin()" class="admin-link">Account</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="hero">
            <div class="hero-media">
                <img src="https://images.unsplash.com/photo-1593113598332-cd288d649433?auto=format&fit=crop&w=2400&q=80" alt="People helping at soup kitchen" />
                <div class="hero-text-overlay">
                    <h1><img src="/images/canya-logo.svg" alt="Canya" class="inline-logo"></h1>
                </div>
            </div>
        </section>

        <section class="container">
            <h2>Our Mission</h2>
            <p>
                Canya is dedicated to building a stronger, more connected community. We believe that by bringing together 
                information about essential services and resources, we can empower people to make a positive difference 
                in their lives and in the world around them.
            </p>
            <p>
                Whether you're passionate about environmental conservation, social justice, or community development, 
                Canya connects you with organizations and initiatives that share your values.
            </p>
        </section>

        <section class="container">
            <h2>Quick Links</h2>
            <div class="grid">
                <div class="card">
                    <div class="card-icon">ðŸ”—</div>
                    <h3>Explore Services</h3>
                    <p>Discover and connect with organizations making a difference</p>
                    <a href="/services" class="btn">View Services</a>
                </div>
                <div class="card">
                    <div class="card-icon">ðŸ‘¥</div>
                    <h3>Meet Our Team</h3>
                    <p>Learn about the dedicated people behind Canya</p>
                    <a href="/about" class="btn btn-secondary">About Us</a>
                </div>
                <div class="card">
                    <div class="card-icon">ðŸŒ±</div>
                    <h3>Get Involved</h3>
                    <p>Join us in creating positive change in your community</p>
                    <a href="#contact" class="btn btn-secondary">Contact Us</a>
                </div>
            </div>
        </section>

        <!-- ld:featured-links-frame:start -->
        <div data-ld-flag-key="featured-links-frame">
            <section class="container" id="featured-links-frame">
                <h2>Featured Resources</h2>
                <p>Check out some of the amazing organizations we're connected with:</p>
                <div id="featured-links" class="grid"></div>
            </section>
        </div>
        <!-- ld:featured-links-frame:end -->

        <!-- ld:chatbot:start -->
        <div data-ld-flag-key="enable-chatbot-for-help">
            <section class="container" id="chatbot-section">
                <h2>Get Answers to Help</h2>
                <p>Have questions? Chat with our AI assistant powered by Gemini</p>
                <div id="chatbot-container">
                    <div id="chat-messages" class="chat-messages"></div>
                    <div class="chat-input-container">
                        <input type="text" id="chat-input" placeholder="Ask a question..." />
                        <button id="chat-send" class="btn">Send</button>
                    </div>
                </div>
            </section>
        </div>
        <!-- ld:chatbot:end -->

        <section class="container" id="contact">
            <h2>Get in Touch</h2>
            <p>Questions or suggestions? We'd love to hear from you!</p>
            <form class="form-row" style="display: block;">
                <div class="form-group">
                    <label for="contact-email">Your Email</label>
                    <input type="email" id="contact-email" placeholder="your@email.com" required>
                </div>
                <div class="form-group">
                    <label for="contact-message">Message</label>
                    <textarea id="contact-message" placeholder="Tell us your thoughts..." required></textarea>
                </div>
                <button type="submit" class="btn">Send Message</button>
            </form>
        </section>
    </main>

    <footer>
        <p>&copy; 2024 Canya - Building Communities Together | <a href="#" style="color: inherit;">Privacy Policy</a></p>
    </footer>

    <script>
        // Check if user is logged in
        function checkUserLogin() {
            const token = localStorage.getItem('token');
            if (token) {
                window.location.href = '/profile';
            } else {
                window.location.href = '/login';
            }
        }

        // Load featured links
        fetch('/api/public/links')
            .then(res => res.json())
            .then(links => {
                const container = document.getElementById('featured-links');
                container.innerHTML = links.slice(0, 3).map(link => `
                    <div class="card">
                        <h3>${link.name}</h3>
                        <p>${link.description}</p>
                        <a href="${link.url}" target="_blank" rel="noopener noreferrer" class="btn btn-secondary">Visit</a>
                    </div>
                `).join('');
            })
            .catch(err => console.error('Error loading links:', err));

        // Handle contact form
        document.querySelector('form').addEventListener('submit', (e) => {
            e.preventDefault();
            alert('Thank you for your message! We will get back to you soon.');
            e.target.reset();
        });
    </script>
</body>
</html>
